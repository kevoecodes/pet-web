"use strict";(self.webpackChunkioms_web=self.webpackChunkioms_web||[]).push([[904],{63669:function(n,t,e){e.d(t,{pf:function(){return d},l:function(){return p},gg:function(){return f},Sh:function(){return c},An:function(){return l}});var o=e(1413),r=e(66212),i=e(41209),s=e(36594),u=e(46417),a=["#ff0707","#ffdd00","#99f600","#ff00dd","#00ffde","#07968a"],c=function(n){return console.log("Pet",!1===n),!0===n?(0,u.jsx)(r.Z,{color:"success",label:"Active"}):!1===n?(0,u.jsx)(r.Z,{color:"error",label:"Inactive"}):void 0},l=function(n){return 0===n?(0,u.jsx)(r.Z,{color:"primary",label:"Admin"}):1===n?(0,u.jsx)(r.Z,{color:"success",label:"User"}):void 0},f=function(n){return new Date(n).toLocaleString()},p=function(n){return"".concat(i.D.mediaURL,"images/").concat(n)},d=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(n){};(0,s.hK)().then((function(e){console.log(e);var r=e.results.map((function(n,t){return(0,o.Z)((0,o.Z)({},n),{},{color:a[t]})}));n(r),t(r)})).catch((function(n){console.log(n)}))}},19239:function(n,t,e){e.d(t,{Z:function(){return P}});var o=e(93433),r=e(74165),i=e(37762),s=e(15861),u=e(29439),a=e(47313),c=e(84697),l=e(9019),f=e(70501),p=e(98466),d=e(69918),h=e(40621),g=e(63669),v=e(36594),m=e(95823),Z=e(18855),k=e(46417),x=function(n){var t=n.pets,e=n.setPet,o=n.current_pet,r=void 0===o?{}:o;return(0,k.jsx)(m.C.Group,{children:t.map((function(n,t){return(0,k.jsx)("a",{href:"#",onClick:function(){console.log("Current",r,n,r===n),null!==r?r.id!==n.id&&e(n):e(n)},children:(0,k.jsx)(Z.Z,{title:n.name,placement:"top",children:(0,k.jsx)(m.C,{style:{backgroundColor:"#87d068"},src:(0,g.l)(n.icon),children:n.name.charAt(0).toUpperCase()})})},t)}))})},w=e(41209),P=function(n){var t=n.real_time,e=void 0!==t&&t,m=n.title,Z=void 0===m?"Pet History":m,P=(0,a.useState)(),b=(0,u.Z)(P,2),S=b[0],y=b[1],C=(0,a.useState)("Population"),j=(0,u.Z)(C,2),L=j[0],R=j[1],U=(0,a.useState)([]),A=(0,u.Z)(U,2),I=A[0],D=A[1],_=(0,a.useState)(null),O=(0,u.Z)(_,2),M=O[0],N=O[1],T=(0,a.useState)([]),z=(0,u.Z)(T,2),E=z[0],J=z[1],W=(0,a.useState)([]),F=(0,u.Z)(W,2),H=F[0],G=F[1],K=(0,a.useState)(!0),Q=(0,u.Z)(K,2),q=Q[0],B=Q[1],V=(0,a.useState)(null),Y=(0,u.Z)(V,2),X=Y[0],$=Y[1],nn=(0,a.useRef)(null),tn=(0,a.useRef)(null),en=function(){console.log("Cleariing polys",E),E.forEach((function(n){return n.polyline.setMap(null)}))},on=function(){H.forEach((function(n){return n.setMap(null)}))};function rn(n){return sn.apply(this,arguments)}function sn(){return(sn=(0,s.Z)((0,r.Z)().mark((function n(t){var e;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,v.RT)(t.id);case 3:return e=n.sent,console.log(e),n.abrupt("return",e.results);case 8:return n.prev=8,n.t0=n.catch(0),console.log(n.t0),n.abrupt("return",[]);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})))).apply(this,arguments)}var un=function(){var n=(0,s.Z)((0,r.Z)().mark((function n(t,e,o,s){var u,a,c,l,f;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null===M){n.next=9;break}return n.next=3,rn(M);case 3:u=n.sent,on(),en(),"Population"===L?(an(t,e,o,u,M.color),B(!1)):(u.length>0&&cn(t,e,u.map((function(n){return{lat:n.latitudes,lng:n.longitudes}})),M.color,M.id),B(!1)),n.next=34;break;case 9:console.log("Here at all"),a=(0,i.Z)(s),n.prev=11,a.s();case 13:if((c=a.n()).done){n.next=25;break}return l=c.value,console.log("The Pet",l),en(),on(),n.next=20,rn(l);case 20:f=n.sent,console.log("Pet iter",l),"Population"===L?an(t,e,o,f,l.color):cn(t,e,f.map((function(n){return{lat:n.latitudes,lng:n.longitudes}})),l.color,l.id);case 23:n.next=13;break;case 25:n.next=30;break;case 27:n.prev=27,n.t0=n.catch(11),a.e(n.t0);case 30:return n.prev=30,a.f(),n.finish(30);case 33:B(!1);case 34:case"end":return n.stop()}}),n,null,[[11,27,30,33]])})));return function(t,e,o,r){return n.apply(this,arguments)}}(),an=function(n,t,e,r,i){var s=r.map((function(o,r){return new n.maps.Marker({position:{lat:o.latitudes,lng:o.longitudes},map:t,title:"Start",icon:{path:e.SymbolPath.CIRCLE,scale:3,fillColor:i,fillOpacity:1,strokeWeight:0}})}));G((function(n){return(0,o.Z)(n).concat(s)}))},cn=function(n,t,e,r,i){var s=new n.maps.Polyline({path:e,geodesic:!0,strokeColor:r,strokeOpacity:1,strokeWeight:2});s.setMap(t),J((function(n){return[].concat((0,o.Z)(n),[{pet_id:i,polyline:s}])}))},ln=function n(t,e,o,r){var i=new WebSocket(w.D.socketURL+"ws/ws-pet-tracker");$(i),i.onopen=function(n){},i.onmessage=function(n){var i=JSON.parse(n.data);if(console.log("Data:",i),null!==i){var s=i.pet_location;fn(s,t,e,o,r)}},i.onclose=function(i){i.wasClean||n(t,e,o,r)},i.onerror=function(i){n(t,e,o,r)}},fn=function(n,t,e,r,i){if(console.log("Here at socketManager",E),"Route"===L)J((function(t){return t.map((function(t){if(t.pet_id===n.pet.id){console.log(t.polyline);var e=t.polyline.getPath();console.log("New Path",e),e.push({lat:n.latitudes,lng:n.longitudes}),t.polyline.setPath(e)}return t}))}));else{console.log("Color",i.find((function(t){return t.id===n.pet.id})).color);var s=new t.maps.Marker({position:{lat:n.latitudes,lng:n.longitudes},map:e,title:"Start",icon:{path:r.SymbolPath.CIRCLE,scale:3,fillColor:i.find((function(t){return t.id===n.pet.id})).color,fillOpacity:1,strokeWeight:0}});G((function(n){return[].concat((0,o.Z)(n),[s])}))}};return(0,a.useEffect)((function(){(0,g.pf)(D,(function(n){return function(n){if(B(!0),nn.current){console.log(nn.current);var t=window.google,o=nn.current,r=tn.current;un(t,o,r,n).then((function(i){null===X&&e&&($("Hello"),ln(t,o,r,n))}))}}(n)}))}),[S,L,M]),(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(h.Z,{title:(0,k.jsx)(k.Fragment,{children:(0,k.jsxs)(l.ZP,{container:!0,spacing:3,alignItems:"center",children:[(0,k.jsx)(l.ZP,{item:!0,children:Z}),(0,k.jsx)(l.ZP,{item:!0,xs:12,md:6,lg:4,sx:{ml:"auto"},children:(0,k.jsx)(x,{pets:I,setPet:N,current_pet:M})}),(0,k.jsx)(l.ZP,{children:(0,k.jsx)(p.Z,{options:["Population","Route"],value:L,onChange:R})})]})}),children:(0,k.jsx)(d.Z,{tip:"Constructing data...",spinning:q,children:(0,k.jsx)(f.Z,{children:(0,k.jsx)("div",{style:{height:"70vh",width:"100%"},children:(0,k.jsx)(c.ZP,{bootstrapURLKeys:{key:"AIzaSyDQz72mL0bI2Li-VJ2AAyFl78sB4UbQIMk"},defaultCenter:{lat:-6.810583,lng:39.257459},defaultZoom:20,yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:function(n){var t=n.map,e=n.maps;nn.current=t,tn.current=e,y(!0)}})})})})})})}},65904:function(n,t,e){e.r(t);var o=e(19239),r=e(46417);t.default=function(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(o.Z,{})})}},36594:function(n,t,e){e.d(t,{LD:function(){return P},OP:function(){return h},Qb:function(){return f},RT:function(){return b},Um:function(){return m},Yb:function(){return v},gi:function(){return g},hK:function(){return Z},mL:function(){return x},rW:function(){return d},us:function(){return w},vy:function(){return p},zd:function(){return k}});var o=e(56573),r=e(41209),i=e(24181);function s(n,t){return new Promise((function(e,i){o.Z.post(r.D.apiURL+n,t).then((function(n){n.headers,e(n.data)})).catch((function(n){n.response&&(401===n.response.status||400===n.response.status||500===n.response.status||n.response&&429===n.response.status||console.log("Error occurred, status: "+n.response.status)),console.log(n),i(n)}))}))}function u(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(s,u){o.Z.get(r.D.apiURL+n,{headers:{Authorization:"Token "+JSON.parse(localStorage.getItem("token"))}}).then((function(n){s(n.data)})).catch((function(n){n.response?n.response&&401===n.response.status&&t&&!e||n.response&&n.response.status:i.s&&i.s.enqueueSnackbar("No network available, Please Connect to a Network!",{variant:"warning"}),u(n)}))}))}function a(n,t){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise((function(s,u){o.Z.post(r.D.apiURL+n,t,{headers:{Authorization:"Token "+JSON.parse(localStorage.getItem("token"))}}).then((function(n){s(n.data)})).catch((function(n){n.response&&401===n.response.status&&e&&!i||(n.response&&n.response.status,u(n))}))}))}function c(n,t){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise((function(s,u){o.Z.put(r.D.apiURL+n,t,{headers:{Authorization:"Token "+JSON.parse(localStorage.getItem("token"))}}).then((function(n){s(n.data)})).catch((function(n){n.response&&401===n.response.status&&e&&!i||(n.response&&n.response.status,u(n))}))}))}function l(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(i,s){o.Z.delete(r.D.apiURL+n,{headers:{Authorization:"Token "+JSON.parse(localStorage.getItem("token"))}}).then((function(n){i(n.data)})).catch((function(n){n.response&&401===n.response.status&&t&&!e||(n.response&&n.response.status,s(n))}))}))}function f(n,t){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o={};return""!==e&&(o.mfaCode=e),s("api/auth/login",{email:n,password:t},!1)}function p(n,t,e){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",r={};return""!==o&&(r.mfaCode=o),a("api/auth/reset-password/"+e,{password:n,confirm_password:t},!1)}function d(){return u("api/v1/users-list/")}function h(n){return a("api/v1/register-user",n)}function g(n){return u("api/v1/user/"+n)}function v(n){return l("api/v1/user/"+n)}function m(n,t){return c("api/v1/user/"+n,t)}function Z(){return u("api/v1/list-pets/")}function k(n){return a("api/v1/pets",n)}function x(n,t){return c("api/v1/pet/"+n,t)}function w(n){return u("api/v1/pet/"+n)}function P(n){return l("api/v1/pet/"+n)}function b(n){return u("api/v1/list-pet-locations/?pet_id="+n)}},41209:function(n,t,e){e.d(t,{D:function(){return o}});var o={mediaURL:"http://161.35.210.153:6500/media/v1/",apiURL:"http://161.35.210.153:5500/",socketURL:"ws://161.35.210.153:5500/"}}}]);